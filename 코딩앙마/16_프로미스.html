<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>프로미스</title>
</head>
<body>
  <pre>
    const pr = new Promise((resolve,reject) => {
      //code
    });
    resolve = 성공
    reject = 실패

    람다함수 부연설명
    https://ponyozzang.tistory.com/452

    어떤 일이 완료되고 실행되는 함수를 callback 함수

    new Promise(), resolve 와 reject, catch 와 finally,

    Promise.all 과 Promise.race


    promise 부연설명
    https://valuefactory.tistory.com/213


  </pre>

  <script>
    //문법
    // const pr = new Promise((resolve,reject) => {
    //   setTimeout(()=>{
    //     resolve("문법 성공!")
    //   },2000);
    // });
    // pr.then(
    //   (result) => {
    //     console.log(result);
    //   }
    // ).catch(
    //   (error) => {
    //     console.log(new Error("문법 에러!"))
    //   }
    // ).finally(
    //   console.log("문법 주문완료!기다려주세요!")
    // )


    // const p1 = () => {
    //   return new Promise((resolve, reject) => {
    //     setTimeout(() => {
    //       resolve("프로미스 1번 주문 완료!")
    //       reject("프로미스 1번 주문 실패!")
    //     }, 1000);
    //   })
    // }
    // const p2 = (message) => {
    //   console.log(message)
    //   return new Promise((resolve, reject) => {
    //     setTimeout(() => {
    //       resolve("프로미스 2번 주문 완료!")
    //       reject("프로미스 2번 주문 실패!")
    //     }, 2000);
    //   })
    // }
    // const p3 = (message) => {
    //   console.log(message)
    //   return new Promise((resolve, reject) => {
    //     setTimeout(() => {
    //       resolve("프로미스 3번 주문 완료!")
    //       reject("프로미스 3번 주문 실패!")
    //     }, 1000);
    //   })
    // }
    // console.log("주문 시작")
    // // p1().then(p2)
    // //   .then(p3)
    // //   .then((result) => console.log(result))
    // //   .catch((err) => console.log(err))
    // //   .finally(() => console.log("프로미스 전체 주문 완료"))
      
    // p1().then((resolve)=>p2(resolve))
    //   .then((resolve)=>p3(resolve))
    //   .then((result) => console.log(result))
    //   .catch((err) => console.log(err))
    //   .finally(() => console.log("프로미스 전체 주문 완료"))

    //콜백지옥
    // const f1 = (callback) => {
    //   setTimeout(() => {
    //     console.log("콜백 1번 주문 완료!")
    //     callback();
    //   }, 1000);
    // }
    // const f2 = (callback) => {
    //   setTimeout(() => {
    //     console.log("콜백 2번 주문 완료!")
    //     callback();
    //   }, 3000);
    // }
    // const f3 = (callback) => {
    //   setTimeout(() => {
    //     console.log("콜백 3번 주문 완료!")
    //     callback();
    //   }, 2000);
    // }
    // f1(() => 
    //   f2(() => 
    //     f3(() => 
    //       console.log("콜백 전체 주문 완료!")
    //     )
    //   )
    // )



    // //판매자 코드
    // const pr = new Promise((resolve, reject) => {
    //   setTimeout(()=>{
    //     resolve('OK');
    //     // reject(new Error('error...'));
    //   },3000);
    // });

    // //소비자 코드
    // pr.then(
    //   function(result){}
    // ).catch(
    //   function(err){}
    // ).finally(
    //   function(){
    //     console.log('====주문 끝====')
    //   }
    // );

    // const pr = new Promise((resolve,reject)=>{
    //   setTimeout(()=>{
    //     // resolve('OK');
    //     reject(new Error('error...'));
    //   },1000);
    // });
    // console.log('시작');
    // pr.then((result)=>{//성공시
    //   console.log(result)
    // }).catch((err)=>{//실패시
    //   console.log(err)
    // }).finally(()=>{
    //   console.log('끝') //항상 뜸
    // });
      
    //콜백지옥
    //1번주문
    // const f1 = (callback)=>{
    //   setTimeout(()=>{
    //     console.log('1번 주문 완료');
    //     callback();
    //   },1000);
    // }
    // //2번주문
    // const f2 = (callback)=>{
    //   setTimeout(()=>{
    //     console.log('2번 주문 완료');
    //     callback();
    //   },2000);
    // }
    // //3번주문
    // const f3 = (callback)=>{
    //   setTimeout(()=>{
    //     console.log('3번 주문 완료');
    //     callback();
    //   },1000);
    // }
    // console.log('시작')
    // f1(()=>{
    //   f2(()=>{
    //     f3(()=>{
    //       console.log('끝')
    //     })
    //   })
    // });

    // const f1 = ()=>{
    //   return new Promise((res,rej)=>{
    //     setTimeout(()=>{
    //       res('1번 주문 완료')
    //     },1000);
    //   });
    // }
    // const f2 = (message)=>{
    //   console.log(message)
    //   return new Promise((res,rej)=>{
    //     setTimeout(()=>{
    //       res('2번 주문 완료')
    //       // rej(new Error('error...'))
    //     },2000);
    //   });
    // }
    // const f3 = (message)=>{
    //   console.log(message)
    //   return new Promise((res,rej)=>{
    //     setTimeout(()=>{
    //       res('3번 주문 완료')
    //     },1000);
    //   });
    // }
    // //프로미스 체이닝
    // console.log('시작')
    // f1().then((res) => f2(res))
    //   .then((res) => f3(res))
    //   .then((res) => console.log(res))
    //   .catch((err) => console.log(err))
    //   .finally(() => console.log('끝'))

    //promise.all 
    // Promise.all([f1(),f2(),f3()]).then(res => {
    //   console.log(res)
    // });
    //promise.race //이미지 로딩시 사용 
    // Promise.race([f1(),f2(),f3()]).then(res => {
    //   console.log(res)
    // });


    // const pr = new Promise((resolve,reject)=>{
    //   setTimeout(() => {
    //     resolve("완료!")
    //     reject("실패!")
    //   }, 1000);
    // });
    // pr.then(
    //   (result)=>{
    //     console.log(result)
    //   }
    // ).catch(
    //   (error)=>{
    //     console.log(error)
    //   }
    // ).finally(
    //   console.log("끝")
    // )
    
    console.log("주문시작!")
    const f1 = ()=>{
      return new Promise((resolve,reject)=>{
        setTimeout(() => {
          resolve("1번 주문완료!")
          reject("1번 주문실패!")
        }, 1000);
      })
    }
    const f2 = (msg)=>{
      console.log(msg)
      return new Promise((resolve,reject)=>{
        setTimeout(() => {
          resolve("2번 주문완료!")
          reject("2번 주문실패!")
        }, 3000);
      })
    }
    const f3 = (msg)=>{
      console.log(msg)
      return new Promise((resolve,reject)=>{
        setTimeout(() => {
          resolve("3번 주문완료!")
          reject("3번 주문실패!")
        }, 2000);
      })
    }
    f1().then((resolve)=>f2(resolve))
        .then((resolve)=>f3(resolve))
        .then((result)=>console.log(result))
        .catch((e)=>console.log(e))
        .finally(()=>console.log("전체 주문완료!"))

    Promise.all([f1(),f2(),f3()]).then(resolve => console.log(resolve))

    Promise.race([f1(),f2(),f3()]).then((resolve)=>console.log(resolve));

  </script>
</body>
</html>